(this.webpackJsonpalfarouq=this.webpackJsonpalfarouq||[]).push([[9],{492:function(e,a,t){"use strict";t.d(a,"a",(function(){return o})),t.d(a,"b",(function(){return u})),t.d(a,"c",(function(){return m}));var n=t(12),r=t(11),i=t.n(r);function c(){var e=Object(n.a)(["\n  mutation UpdateRevReport($id: ID!, $decision: String) {\n    updateRevReport(id: $id, data: { decision: $decision }) {\n      _id\n    }\n  }\n"]);return c=function(){return e},e}function l(){var e=Object(n.a)(["\n  query RevReports {\n    revReports {\n      _id\n      createdAt\n      report\n      decision\n      from {\n        _id\n        userName\n        email\n      }\n      review {\n        _id\n        text\n        business {\n          _id\n        }\n      }\n    }\n  }\n"]);return l=function(){return e},e}function s(){var e=Object(n.a)(["\n  mutation CreateRevReport($id: ID!, $report: String!) {\n    createRevReport(data: { id: $id, report: $report }) {\n      _id\n    }\n  }\n"]);return s=function(){return e},e}var o=i()(s()),u=i()(l()),m=i()(c())},494:function(e,a,t){"use strict";var n=t(500),r=t(501),i=t(507),c=t(502),l=t(508),s=t(1),o=t.n(s),u=(t(503),t(504),function(e){return e.show?o.a.createElement("div",{className:"Backdrop",onClick:e.clicked}):null}),m=function(e){function a(){return Object(n.a)(this,a),Object(i.a)(this,Object(c.a)(a).apply(this,arguments))}return Object(l.a)(a,e),Object(r.a)(a,[{key:"shouldComponentUpdate",value:function(e,a){return e.show!==this.props.show||e.update!==this.props.update}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement(u,{show:this.props.show,clicked:this.props.modalClosed}),o.a.createElement("div",{className:"Modal",style:{transform:this.props.show?"translateY(0)":"translateY(-100vh)",opacity:this.props.show?"1":"0"}},this.props.show?this.props.children:null))}}]),a}(s.Component);a.a=m},503:function(e,a,t){},504:function(e,a,t){},509:function(e,a,t){"use strict";var n=t(10),r=t(1),i=t.n(r),c=t(13),l=t(512),s=t.n(l),o=t(18),u=t(492),m=t(165),d=function(e){var a=e.reviewId,t=Object(r.useState)(!1),c=Object(n.a)(t,2),l=c[0],d=c[1],v=Object(r.useState)({message:null,type:null}),p=Object(n.a)(v,2),b=p[0],E=p[1],g=Object(r.useState)("explain why review is inapropriate"),_=Object(n.a)(g,2),f=_[0],h=_[1],w=Object(o.b)(u.a,{onCompleted:function(e){e.updateImage;d(!1),E({message:"Thank you we will check the review",type:"sucess"})},onError:function(e){var a=e.message.replace("GraphQL error:","");E({message:a,type:"error"})}}),y=Object(n.a)(w,2),O=y[0];y[1].loading;return i.a.createElement("div",{className:s.a.mainContainer},i.a.createElement("div",null,i.a.createElement("textarea",{className:s.a.textAreaDesc,onChange:function(e){E({message:null,type:null});e.target.value;h(e.target.value)},value:f})),i.a.createElement("span",{className:s.a.btnDesc,onClick:function(){if(!l){d(!0);var e=f.length;0==e?(E({message:"Please explain why",type:"error"}),d(!1)):f&&e>100?(E({message:"Do not exceed 100 letters you are at ".concat(e),type:"error"}),d(!1)):O({variables:{id:a,report:f}})}}},"Submit"),b.message&&i.a.createElement(m.a,{message:b.message,type:b.type}))},v=t(494),p=t(513),b=t.n(p),E=t(168),g=t(124),_=t(106),f=t(514),h=t.n(f),w=t(137),y=t(31),O=t(61),C=t(39),j=t(78),R=t(170);a.a=function(e){var a=e.review,t=Object(r.useState)(!1),l=Object(n.a)(t,2),s=l[0],o=l[1],u=Object(w.useMediaQuery)({query:"(min-device-width: 768px)"});console.log(a);var m=Object(R.a)(a),p=null,f=null,N=!1,S="business";"undefined"!=typeof a.business?(p=a.business,f="/business/".concat(p._id)):"undefined"!=typeof a.author&&((p=a.author).name=p.userName,f="/profile/".concat(p._id),S="profile",N=!0);var B=h()(a.createdAt);return i.a.createElement(r.Fragment,null,i.a.createElement(v.a,{show:s,modalClosed:function(){o(!1)}},i.a.createElement(d,{reviewId:a._id})),i.a.createElement("div",{className:b.a.revContainer,id:a._id,key:a._id},i.a.createElement("div",{className:b.a.revContainerInner},i.a.createElement("div",{className:b.a.revContainerAvatar},p.picture?i.a.createElement("img",{src:p.picture}):N?i.a.createElement(j.a,{size:"90%",color:"#0996e8"}):i.a.createElement(C.d,{size:"90%",color:"#0996e8"})),i.a.createElement("div",null,i.a.createElement("div",{className:b.a.revAuth},i.a.createElement(c.Link,{to:f},Object(y.b)(p.name))),i.a.createElement("div",{className:b.a.revChips},i.a.createElement("div",{className:"chipsContainer"},N&&i.a.createElement("div",{className:"chip"},i.a.createElement(O.a,{color:"#0996e8"}),i.a.createElement("div",{className:"label"},"".concat(p.followers.length," ").concat(u?"Followers":""))),i.a.createElement("div",{className:"chip"},i.a.createElement(O.b,{color:"#0996e8"}),i.a.createElement("div",{className:"label"},"".concat(p.nbrRev," ").concat(u?"Reviews":"")," ")),i.a.createElement("div",{className:"chip"},i.a.createElement(C.a,{color:"#0996e8"}),i.a.createElement("div",{className:"label"},"".concat(p.revPic," ").concat(u?"Photos":""))))),i.a.createElement("div",{className:b.a.location},i.a.createElement(c.Link,{to:"/business/location/casablanca"},"Casablanca")),i.a.createElement("div",{className:b.a.revRating},i.a.createElement(_.a,{value:a.rating,size:u?"medium":"small",readOnly:!0}),i.a.createElement("div",{className:b.a.date},B.format("DD-MM-YYYY"))))),i.a.createElement("p",{className:b.a.revDesc},a.text),i.a.createElement("div",{className:b.a.revPicture},i.a.createElement(E.a,{images:m,type:S})),i.a.createElement("div",{className:b.a.clap},i.a.createElement(g.a,{claps:a.claps||0,id:a._id,type:"review"})),i.a.createElement("p",{className:b.a.report},"if review is inappropriate please",i.a.createElement("span",{className:b.a.reportbtn,onClick:function(){return o(!0)}},"report it"))))}},512:function(e,a,t){e.exports={mainContainer:"ReviewReportForm_mainContainer__D1aU4",textAreaDesc:"ReviewReportForm_textAreaDesc__3KLWM",btnDesc:"ReviewReportForm_btnDesc__3oEpB"}},513:function(e,a,t){e.exports={revContainer:"ReviewCard_revContainer__1zAEQ",revContainerInner:"ReviewCard_revContainerInner___NqKk",revContainerAvatar:"ReviewCard_revContainerAvatar__24jYS",revAuth:"ReviewCard_revAuth__3-Ul-",date:"ReviewCard_date__1TuXG",revChips:"ReviewCard_revChips__Tv0KD",location:"ReviewCard_location__3XDeC",revDesc:"ReviewCard_revDesc__KU6sl",revRating:"ReviewCard_revRating__MTHIJ",clap:"ReviewCard_clap__3x5kp",report:"ReviewCard_report__2Zp2b",reportbtn:"ReviewCard_reportbtn__kwa21"}},549:function(e,a,t){e.exports={modalBtn:"BuzSinglePic_modalBtn__qWgo3",imgGridTop:"BuzSinglePic_imgGridTop__YPLKl",singleImg:"BuzSinglePic_singleImg__pJiWZ"}},550:function(e,a,t){e.exports={head:"BuzSingleHead_head__1Envl",headInner:"BuzSingleHead_headInner__-l25O",profileImg:"BuzSingleHead_profileImg__2eGR0",name:"BuzSingleHead_name__2BOG0",price:"BuzSingleHead_price__3WLMV",subCat:"BuzSingleHead_subCat__16FnG",location:"BuzSingleHead_location__2olMw",revRating:"BuzSingleHead_revRating__2KGSe",claim:"BuzSingleHead_claim__APQKi",imageContainer:"BuzSingleHead_imageContainer__3Y5ej",reviewClaim:"BuzSingleHead_reviewClaim__2EKat"}},551:function(e,a,t){e.exports={error:"ReviewForm_error__3kK-T",dropZone:"ReviewForm_dropZone__1Uoeu"}},553:function(e,a,t){e.exports={mainBody:"BuzSingleDesc_mainBody__2S4N3"}},554:function(e,a,t){e.exports={mainBody:"BuzSingleReviews_mainBody__ySEIz",reviewCard:"BuzSingleReviews_reviewCard__2yWyT"}},591:function(e,a,t){"use strict";t.r(a);var n=t(531),r=t(1),i=t.n(r),c=t(105),l=t(18),s=t(38),o=t(168),u=t(549),m=t.n(u),d=t(170);var v=function(e){var a=e.reviews,t=Object(d.a)(a);return i.a.createElement(i.a.Fragment,null,t&&i.a.createElement("div",{className:m.a.mainContainer},i.a.createElement(o.a,{images:t,top:!0})))},p=t(10),b=t(94),E=t(13),g=t(448),_=t(600),f=t(550),h=t.n(f),w=t(552),y=t.n(w),O=t(494),C=t(25),j=t(35),R=t(551),N=t.n(R),S=t(260),B=t(40),k=t(233);var x=function(e){var a=e.field,t=e.form,c=a.name,l=t.setFieldValue,s=Object(r.useState)([]),u=Object(p.a)(s,2),m=u[0],d=u[1],v=Object(r.useState)([]),b=Object(p.a)(v,2),E=b[0],g=b[1],_=Object(k.a)({onDrop:function(e){d([]);var a=e.slice(-3),t=[].concat(Object(n.a)(E),Object(n.a)(a)).slice(-3);switch(g(t),t.length){case 1:d(m.slice(0,1));break;case 1:d(m.slice(0,2));break;case 1:d(m.slice(0,3))}var r=!0,i=!1,s=void 0;try{for(var o,u=function(){var e=o.value,a=new FileReader;a.addEventListener("load",(function(){d((function(e){return[].concat(Object(n.a)(e),[{name:a.result}])}))}),!1),a.readAsDataURL(e)},v=t[Symbol.iterator]();!(r=(o=v.next()).done);r=!0)u()}catch(p){i=!0,s=p}finally{try{r||null==v.return||v.return()}finally{if(i)throw s}}l(c,t)},multiple:!0}),f=_.getRootProps,h=_.getInputProps;return _.isDragActive,i.a.createElement("section",null,i.a.createElement("div",f({className:"dropzone"}),i.a.createElement("input",h()),i.a.createElement("p",null,"Select up to 3 images")),m.length?i.a.createElement(o.a,{images:m}):null)};function z(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function D(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?z(t,!0).forEach((function(a){Object(b.a)(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):z(t).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}var I=function(e){var a=e.onSubmit,t=e.businessId,n=Object(C.f)({mapPropsToValues:function(e){return{rating:e.rating||null,text:e.text||"",picture:e.picture||[]}},validationSchema:j.object().shape({rating:j.number().required("Email is required"),text:j.string().max(800,"review too long")}),handleSubmit:function(e,n){n.setSubmitting,n.setFieldError;a({variables:D({},e,{business:t})})}})((function(e){var a=e.values,t=e.errors,n=(e.touched,e.setFieldValue);return i.a.createElement("div",{className:N.a.topContainer},i.a.createElement("div",{className:N.a.container},i.a.createElement(C.d,null,i.a.createElement("div",{className:N.a.innerContainer},i.a.createElement("div",null,i.a.createElement(S.a,{name:"rating",value:a.rating,onChange:function(e,a){n("rating",a)}}),t.rating&&i.a.createElement("p",{className:N.a.error}," please add a rating")),i.a.createElement("div",null,i.a.createElement(B.c,{multiline:!0,rows:"4",name:"text",label:"Business Description"})),i.a.createElement("div",{className:N.a.dropZone},i.a.createElement(C.b,{name:"picture",component:x})),i.a.createElement(B.a,{type:"submit"},"Send Review")))))}));return i.a.createElement(n,null)},A=t(126),P=t(30),T=function(e){var a=e.businessId,t=e.setBuzStat,n=e.modalClosed,c=Object(r.useContext)(P.a),o=Object(l.b)(A.a,{onCompleted:function(e){var a=e.createReview;t(a.business),c({type:"flashMessage",value:{message:"Thank you, Review created",type:"success"}}),n(),window.scrollTo(0,0)},onError:function(e){c({type:"flashMessage",value:{message:"Review Not Added: ".concat(e.message.replace("GraphQL error:","")),type:"error"}}),n(),window.scrollTo(0,0)}}),u=Object(p.a)(o,2),m=u[0],d=u[1],v=d.loading;d.error;return i.a.createElement("div",null,v&&i.a.createElement(s.a,null),i.a.createElement("h2",null,"Add a review"),i.a.createElement(I,{onSubmit:m,businessId:a}))},F=t(28),M=t(106),L=t(31),H=t(137),G=t(39),q=Object(g.a)((function(e){return{chip:Object(b.a)({padding:"1rem",fontSize:"0.9rem"},e.breakpoints.up("sm"),{fontSize:"1.2rem"})}}));var K=function(e){var a=e.history,t=e.business,n=q(),o=Object(r.useState)(null),u=Object(p.a)(o,2),m=u[0],d=u[1],v=Object(r.useContext)(P.a),b=Object(r.useState)(!1),g=Object(p.a)(b,2),f=g[0],w=g[1],C=Object(H.useMediaQuery)({query:"(min-device-width: 768px)"}),j=t._id,R=t.name,N=t.neighborhood,S=t.city,B=t.picture,k=t.subCat,x=t.cat,z=t.nbrRev,D=t.totRev,I=t.owner,A=t.price,K=Object(l.b)(c.b,{onCompleted:function(){v({type:"flashMessage",value:{message:"claim is sent, we will soon contact you via email",type:"success"}}),window.scrollTo(0,0)},onError:function(){v({type:"flashMessage",value:{message:"Somethicng is wrong please try again later",type:"error"}}),window.scrollTo(0,0)}}),Y=Object(p.a)(K,2),$=Y[0],Q=Y[1],U=(Q.data,Q.error),W=Q.loading;U&&(v({type:"flashMessage",value:{message:"Somethicng is wrong please try again later",type:"error"}}),window.scrollTo(0,0)),null!=m&&(z=m.nbrRev,D=m.totRev);var Z=z?D/z:0,J=function(){w(!1)};return console.log(A),i.a.createElement(r.Fragment,null,i.a.createElement(O.a,{show:f,modalClosed:J},i.a.createElement(T,{businessId:j,setBuzStat:d,modalClosed:J})),i.a.createElement("div",{className:h.a.head},i.a.createElement("div",{className:h.a.headInner},i.a.createElement("div",{className:h.a.imageContainer},B?i.a.createElement("img",{src:B}):i.a.createElement(G.d,{size:"90%",color:"#0996e8"})),i.a.createElement("div",null,i.a.createElement("h2",{className:h.a.name},Object(L.b)(R)),i.a.createElement("div",{className:h.a.price},A),i.a.createElement("div",{className:h.a.revRating},i.a.createElement(M.a,{value:Z,size:C?"medium":"small",precision:.5,readOnly:!0}),i.a.createElement("div",null,z," review",z>1?"s":null)),i.a.createElement("div",{className:h.a.location},i.a.createElement(E.Link,{to:"/tax/location/".concat(S,"/").concat(N,"?cat=").concat(x)},N,", "),i.a.createElement(E.Link,{to:"/tax/location/".concat(S,"?cat=").concat(x)},S," ")),i.a.createElement("div",{className:h.a.subCat},k.map((function(e,a){return i.a.createElement("span",{key:a},i.a.createElement(E.Link,{to:"/tax/category/".concat(x,"/").concat(e,"?city=").concat(S)},e,", ")," ")}))))),i.a.createElement("div",{className:h.a.reviewClaim},i.a.createElement("div",null,i.a.createElement(_.a,{className:n.chip,color:"primary",size:C?"medium":"small",icon:i.a.createElement(y.a,null),label:"Review Business",clickable:!0,onClick:function(){Object(F.c)(a,v)&&w(!0)}})),!I&&i.a.createElement("p",{className:h.a.claim,onClick:function(){$({variables:{business:j}})}},"Claim it !"))),W&&i.a.createElement(s.a,null))},Y=t(553),$=t.n(Y);var Q=function(e){return i.a.createElement("div",null,i.a.createElement("div",{className:$.a.mainBody},i.a.createElement("h2",{className:"sectionTitle"},"About the Business"),i.a.createElement("div",null,e.desc)))},U=t(554),W=t.n(U),Z=t(509);var J=function(e){var a=e.reviews;return i.a.createElement("div",{className:W.a.mainBody},i.a.createElement("h2",{className:"sectionTitle"},"Reviews"),a.map((function(e){return i.a.createElement(Z.a,{review:e,key:e._id})})))},V=t(77);a.default=function(e){var a=Object(r.useContext)(P.a),t=Object(l.c)(c.f,{variables:{id:e.match.params.id,onlyAuthor:!1}}),o=t.loading,u=t.error,m=t.data;Object(r.useEffect)((function(){u&&a({type:"flashMessage",value:{message:u.message.replace("GraphQL error:",""),type:"error"}})}),[u]);var d=null,p=null,b=[];return"undefined"!=typeof m&&(p=(d=m?m.business:null)?d.reviews:null,b=[],"undefined"!=typeof p&&p.forEach((function(e){Array.isArray(e.picture)&&(b=[].concat(Object(n.a)(b),Object(n.a)(e.picture)))}))),i.a.createElement(V.a,{title:"Business Page",withTopBar:!0},o&&i.a.createElement(s.a,null),d&&i.a.createElement(i.a.Fragment,null,i.a.createElement(v,{reviews:p}),i.a.createElement(K,{business:d,history:e.history}),i.a.createElement(Q,{desc:d.desc}),i.a.createElement(J,{reviews:p})))}}}]);
//# sourceMappingURL=9.cb16be6f.chunk.js.map