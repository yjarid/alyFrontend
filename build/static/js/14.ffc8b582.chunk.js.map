{"version":3,"sources":["components/Business/NewBuz/Editbuz.js"],"names":["EditBuz","props","appState","useContext","StateContext","appDispatch","DispatchContext","useState","updatedBus","setUpdatedBus","loginRequired","history","id","match","params","useQuery","GET_BUSINESS","variables","onlyAuthor","loading","error","data","useEffect","type","value","message","useMutation","UPDATE_BUSINESS","onCompleted","updateBusiness","name","window","scrollTo","onError","business","title","withTopBar","user","published","className","styles","unpublish","onClick","formTitle","onSubmit"],"mappings":"sNAqEeA,UA3DC,SAAAC,GACd,IAAMC,EAAWC,qBAAWC,KACtBC,EAAcF,qBAAWG,KAFR,EAGaC,mBAAS,MAHtB,mBAGhBC,EAHgB,KAGJC,EAHI,KAKvBC,YAAcT,EAAMU,QAASN,GAE7B,IAAMO,EAAKX,EAAMY,MAAMC,OAAOF,GAPP,EASUG,YAASC,IAAc,CACtDC,UAAW,CAAEL,KAAIM,YAAY,KADvBC,EATe,EASfA,QAASC,EATM,EASNA,MAAOC,EATD,EASCA,KAIxBC,qBAAU,WACJF,GACFf,EAAY,CAAEkB,KAAM,eAAgBC,MAAO,CAAEC,QAAS,6CAA8CF,KAAM,aAE3G,CAACH,IAjBmB,MAmBEM,YAAYC,IAAiB,CACpDC,YADoD,YACnB,IAAnBC,EAAkB,EAAlBA,eACZpB,EAAcoB,GACdxB,EAAY,CAAEkB,KAAM,eAAgBC,MAAO,CAAEC,QAAQ,YAAD,OAAcI,EAAeC,KAA7B,eAAgDP,KAAM,aAC1GQ,OAAOC,SAAS,EAAG,IAErBC,QANoD,WAOlD5B,EAAY,CAAEkB,KAAM,eAAgBC,MAAO,CAAEC,QAAS,6CAA8CF,KAAM,WAC1GQ,OAAOC,SAAS,EAAG,MARhBH,EAnBgB,oBAmCvB,GAAIV,EACF,OAAO,kBAAC,IAAD,MAGLC,IACFW,OAAOC,SAAS,EAAG,GACnB3B,EAAY,CAAEkB,KAAM,eAAgBC,MAAO,CAAEC,QAAS,6CAA8CF,KAAM,YAG5Ff,GAAea,GAAOA,EAAKa,SAE3C,OACE,kBAAC,IAAD,CAAMC,MAAM,gBAAgBC,YAAY,GACf,SAAtBlC,EAASmC,KAAKd,MAAmBF,EAAKa,SAASI,WAC9C,yBAAKC,UAAWC,IAAOC,UAAWC,QAlBpB,WAClBb,EAAe,CAAEZ,UAAW,CAAEL,KAAI0B,WAAW,OAiBzC,aAIF,wBAAIC,UAAWC,IAAOG,WAAtB,QAAuCtB,EAAKa,SAASJ,MACrD,kBAAC,IAAD,eAASc,SAAUf,GAAoBR,EAAKa,SAA5C,CAAsDtB,GAAIA","file":"static/js/14.ffc8b582.chunk.js","sourcesContent":["import React, { useEffect, useContext, useState } from \"react\"\r\nimport BuzForm from \"./BuzForm/BuzForm\"\r\nimport styles from \"./Newbuz.module.scss\"\r\nimport Page from \"../../Page/Page\"\r\nimport Spinner from \"../../UI/Spinner/Spinner\"\r\nimport { useQuery, useMutation } from \"@apollo/react-hooks\"\r\nimport { UPDATE_BUSINESS, GET_BUSINESS } from \"../../../qraphQl/businessType\"\r\nimport { loginRequired } from \"../../../AccessToken\"\r\nimport { StateContext, DispatchContext } from \"../../../Context\"\r\n\r\nconst EditBuz = props => {\r\n  const appState = useContext(StateContext)\r\n  const appDispatch = useContext(DispatchContext)\r\n  const [updatedBus, setUpdatedBus] = useState(null)\r\n\r\n  loginRequired(props.history, appDispatch)\r\n\r\n  const id = props.match.params.id\r\n\r\n  const { loading, error, data } = useQuery(GET_BUSINESS, {\r\n    variables: { id, onlyAuthor: true }\r\n  })\r\n\r\n  useEffect(() => {\r\n    if (error) {\r\n      appDispatch({ type: \"flashMessage\", value: { message: \"Somethicng is wrong please try again later\", type: \"error\" } })\r\n    }\r\n  }, [error])\r\n\r\n  const [updateBusiness] = useMutation(UPDATE_BUSINESS, {\r\n    onCompleted({ updateBusiness }) {\r\n      setUpdatedBus(updateBusiness)\r\n      appDispatch({ type: \"flashMessage\", value: { message: `Business ${updateBusiness.name} is updated`, type: \"success\" } })\r\n      window.scrollTo(0, 0)\r\n    },\r\n    onError() {\r\n      appDispatch({ type: \"flashMessage\", value: { message: \"Somethicng is wrong please try again later\", type: \"error\" } })\r\n      window.scrollTo(0, 0)\r\n    }\r\n  })\r\n\r\n  const upublishBus = () => {\r\n    updateBusiness({ variables: { id, published: false } })\r\n  }\r\n\r\n  if (loading) {\r\n    return <Spinner />\r\n  }\r\n\r\n  if (error) {\r\n    window.scrollTo(0, 0)\r\n    appDispatch({ type: \"flashMessage\", value: { message: \"Somethicng is wrong please try again later\", type: \"error\" } })\r\n  }\r\n\r\n  let finalData = updatedBus || (data ? data.business : null)\r\n\r\n  return (\r\n    <Page title=\"Edit Business\" withTopBar={false}>\r\n      {appState.user.type == \"ADMIN\" && data.business.published && (\r\n        <div className={styles.unpublish} onClick={upublishBus}>\r\n          Unpublish\r\n        </div>\r\n      )}\r\n      <h3 className={styles.formTitle}>Edit {data.business.name}</h3>\r\n      <BuzForm onSubmit={updateBusiness} {...data.business} id={id} />\r\n    </Page>\r\n  )\r\n}\r\n\r\nexport default EditBuz\r\n"],"sourceRoot":""}