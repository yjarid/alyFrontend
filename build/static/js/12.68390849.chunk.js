(this.webpackJsonpalfarouq=this.webpackJsonpalfarouq||[]).push([[12],{495:function(e,t,a){e.exports={selectedBus:"MapResult_selectedBus__3BR5a",busCard:"MapResult_busCard__2EnNv"}},498:function(e,t,a){e.exports={searchResContainer:"MapResultPage_searchResContainer__27PT7",mapContainer:"MapResultPage_mapContainer__3nirv",fixContainer:"MapResultPage_fixContainer__DU6q7",listMap:"MapResultPage_listMap__1YLp_"}},499:function(e,t,a){e.exports={rating:"SimpleMap_rating__16dYM",popUpTitle:"SimpleMap_popUpTitle__1hYOa"}},506:function(e,t,a){"use strict";var n=a(10),r=a(1),c=a.n(r),o=a(167),s=a(495),l=a.n(s),i=(a(31),a(496)),u=a.n(i),m=a(497),p=a(172),f=a.n(p),b=(function(){var e}(),function(e){return window.scrollTo(0,e.current.offsetTop)});var d=function(e){var t=e.data,a=e.selectedBus,n=e.selectedBusFunc,s=e.scroll,i=Object(r.useRef)(null),u=a?a._id:null;return Object(r.useEffect)((function(){i.current&&s&&b(i)}),[u,s]),c.a.createElement("div",null,c.a.createElement("div",{className:l.a.gridContainer},t.map((function(e,t){return e._id==u?c.a.createElement("div",{key:t,ref:i,className:l.a.selectedBus,onMouseEnter:function(){return n(e)}},c.a.createElement(o.a,{data:e})):c.a.createElement("div",{className:l.a.busCard,key:t,onMouseEnter:function(){return n(e,!1)}},c.a.createElement(o.a,{data:e}))}))))},O=a(498),g=a.n(O),j=a(94),E=a(597),v=a(598),h=a(593),_=a(575),y=a(599),M=a(489),S=a.n(M),B=a(106),C=a(13),R=a(499),w=a.n(R),P=function(e){var t=Object(r.useState)([]),a=Object(n.a)(t,2),c=a[0],o=a[1],s=Object(r.useState)([]),l=Object(n.a)(s,2),i=l[0],u=l[1],m=Object(r.useState)(8),p=Object(n.a)(m,2),f=p[0],b=p[1];if(c.length>=0){var d=(c[1]+c[3])/2,O=(c[0]+c[2])/2,g=(i[1]+i[3])/2,j=(i[0]+i[2])/2,E=Math.abs(d-g)+Math.abs(O-j);f!=e?(b(e),u(c)):(E>=.04&&e>=11||E>=.03&&13==e||E>=.02&&14==e||E>=.01&&e>=15||E>=.006&&e>=17)&&(b(e),u(c))}return[i,o]},N=new S.a.Icon({iconUrl:"/svg/marker.svg",iconSize:[25,25]}),k=new S.a.Icon({iconUrl:"/svg/marker-blue.svg",iconSize:[25,25]});function x(e){var t,a=e.data,o=e.area,s=e.initZoom,l=e.mapBounds,i=e.selectedBusFunc,u=e.selectedBusfromParent,m=Object(r.useState)(s),p=Object(n.a)(m,2),f=p[0],b=p[1],d=Object(r.useState)(u),O=Object(n.a)(d,2),g=O[0],M=O[1],S=Object(r.useRef)(),R=Object(r.useRef)(),x=P(Math.max(f,s)),T=Object(n.a)(x,2),z=T[0],U=T[1],D=u?u._id:null,F=a||[],Z=o?[o.lat,o.lng]:[31.791702,-7.09262];function q(){var e=S.current.leafletElement.getBounds(),t=S.current.leafletElement.getZoom(),a=[e.getSouthWest().lng,e.getSouthWest().lat,e.getNorthEast().lng,e.getNorthEast().lat];console.log(a),b(t),U(a)}console.log(F),Object(r.useEffect)((function(){M(u)}),[D]),Object(r.useEffect)((function(){l(z)}),[z]);return c.a.createElement(E.a,(t={onViewportChanged:q,center:Z,zoom:f,minZoom:11},Object(j.a)(t,"onViewportChanged",q),Object(j.a)(t,"ref",S),t),c.a.createElement(v.a,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}),c.a.createElement(h.a,{ref:R},F.map((function(e){var t,a=e.nbrRev?e.totRev/e.nbrRev:0;return c.a.createElement(_.a,{position:[e.location.coordinates[1],e.location.coordinates[0]],icon:(t=e._id,g&&t==g._id?N:k),onClick:function(){return function(e){M(e),i(e,!0)}(e)},onMouseOver:function(t){return function(e,t){e.target.openPopup(),M(t)}(t,e)},key:e._id},g&&c.a.createElement(y.a,{position:[g.location.coordinates[1],g.location.coordinates[0]],autoPan:!1},c.a.createElement("div",null,c.a.createElement("div",{className:w.a.popUpTitle},c.a.createElement(C.Link,{to:"/business/".concat(g._id)},g.name)),c.a.createElement("div",{className:w.a.rating},c.a.createElement(B.a,{name:"customized-color",value:a,precision:.5,size:"small",readOnly:!0}),c.a.createElement("div",null,e.nbrRev," reviews")))))}))))}t.a=function(e){var t=e.businesses,a=e.location,o=e.mapBounds2,s=e.zoom,l=Object(r.useState)(null),i=Object(n.a)(l,2),u=i[0],m=i[1],p=Object(r.useState)(!1),f=Object(n.a)(p,2),b=f[0],O=f[1],j=Object(r.useState)(null),E=Object(n.a)(j,2),v=E[0],h=E[1],_=function(e,t){m(e),O(t)};return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:g.a.listMap},c.a.createElement("button",null,c.a.createElement("span",{className:g.a.listMapBtn,onClick:function(){return h("list")}},"List")),c.a.createElement("button",null,c.a.createElement("span",{className:g.a.listMapBtn,onClick:function(){return h("map")}},"Map"))),c.a.createElement("div",{className:g.a.searchResContainer},(!v||"list"==v)&&c.a.createElement(d,{data:t,selectedBus:u,selectedBusFunc:_,scroll:b}),c.a.createElement("div",{className:g.a.fixContainer},c.a.createElement("div",{className:g.a.mapContainer},(!v||"map"==v)&&c.a.createElement(x,{data:t,area:a?{lat:a.lat,lng:a.lng}:{lat:"33.573109",lng:"-7.617050"},mapBounds:function(e){return o(e)},initZoom:s,selectedBusFunc:_,selectedBusfromParent:u})))))}},537:function(e,t,a){},574:function(e,t,a){"use strict";a.r(t);var n=a(94),r=a(10),c=a(1),o=a.n(c),s=a(52),l=a(105),i=a(164),u=a(38),m=(a(537),a(77)),p=a(18),f=a(173),b=a.n(f),d=a(30),O=a(506),g=a(31);function j(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function E(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?j(a,!0).forEach((function(t){Object(n.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):j(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}t.default=function(e){var t=Object(c.useContext)(d.a),a=Object(c.useState)([]),n=Object(r.a)(a,2),f=n[0],j=n[1],v=Object(c.useState)(12),h=Object(r.a)(v,2),_=h[0],y=h[1],M=Object(s.m)(),S=M.type,B=M.tax,C=M.subTax,R=b.a.parse(e.location.search),w=R.city,P=R.cat,N=Object(p.a)(l.e),k=Object(r.a)(N,2),x=k[0],T=k[1],z=T.loading,U=T.data,D=T.error,F=Object(p.a)(i.f),Z=Object(r.a)(F,2),q=Z[0],L=Z[1].data,Y="undefined"!=typeof U?U.businesses:[],I="undefined"!=typeof L?L.location:null;return Object(c.useEffect)((function(){"location"==S&&(C?(q({variables:{neigh:C}}),y(14)):q({variables:{neigh:B}}))}),[]),Object(c.useEffect)((function(){var e={limit:20};"location"==S?(e.cat=P,C&&(e.neighborhood=C),e.city=B):"category"==S&&(e.city=w,C&&(e.subCat=C),e.cat=B),x({variables:E({},e,{bound:f})})}),[f[0],B,C,w,P]),Object(c.useEffect)((function(){D&&t({type:"flashMessage",value:{message:"Something went wrong",type:"error"}})}),[D]),o.a.createElement(m.a,{title:"Search Results",withTopBar:!0},z&&o.a.createElement(u.a,null),o.a.createElement("h2",{className:"searchTitle"},"Results for ",Object(g.b)(P||C||B)," in ",Object(g.b)(w||C||B)),o.a.createElement(O.a,{businesses:Y,location:I,mapBounds2:function(e){j(e)},zoom:_}))}}}]);
//# sourceMappingURL=12.68390849.chunk.js.map