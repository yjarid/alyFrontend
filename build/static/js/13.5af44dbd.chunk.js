(this.webpackJsonpalfarouq=this.webpackJsonpalfarouq||[]).push([[13],{495:function(e,t,a){e.exports={selectedBus:"MapResult_selectedBus__3BR5a",busCard:"MapResult_busCard__2EnNv"}},498:function(e,t,a){e.exports={searchResContainer:"MapResultPage_searchResContainer__27PT7",mapContainer:"MapResultPage_mapContainer__3nirv",fixContainer:"MapResultPage_fixContainer__DU6q7",listMap:"MapResultPage_listMap__1YLp_"}},499:function(e,t,a){e.exports={rating:"SimpleMap_rating__16dYM",popUpTitle:"SimpleMap_popUpTitle__1hYOa"}},506:function(e,t,a){"use strict";var n=a(10),c=a(1),r=a.n(c),o=a(167),s=a(495),l=a.n(s),i=(a(31),a(496)),u=a.n(i),m=a(497),p=a(172),f=a.n(p),d=(function(){var e}(),function(e){return window.scrollTo(0,e.current.offsetTop)});var b=function(e){var t=e.data,a=e.selectedBus,n=e.selectedBusFunc,s=e.scroll,i=Object(c.useRef)(null),u=a?a._id:null;return Object(c.useEffect)((function(){i.current&&s&&d(i)}),[u,s]),r.a.createElement("div",null,r.a.createElement("div",{className:l.a.gridContainer},t.map((function(e,t){return e._id==u?r.a.createElement("div",{key:t,ref:i,className:l.a.selectedBus,onMouseEnter:function(){return n(e)}},r.a.createElement(o.a,{data:e})):r.a.createElement("div",{className:l.a.busCard,key:t,onMouseEnter:function(){return n(e,!1)}},r.a.createElement(o.a,{data:e}))}))))},E=a(498),g=a.n(E),v=a(94),O=a(597),j=a(598),_=a(593),h=a(575),M=a(599),B=a(489),C=a.n(B),R=a(106),S=a(13),N=a(499),y=a.n(N),w=function(e){var t=Object(c.useState)([]),a=Object(n.a)(t,2),r=a[0],o=a[1],s=Object(c.useState)([]),l=Object(n.a)(s,2),i=l[0],u=l[1],m=Object(c.useState)(8),p=Object(n.a)(m,2),f=p[0],d=p[1];if(r.length>=0){var b=(r[1]+r[3])/2,E=(r[0]+r[2])/2,g=(i[1]+i[3])/2,v=(i[0]+i[2])/2,O=Math.abs(b-g)+Math.abs(E-v);f!=e?(d(e),u(r)):(O>=.04&&e>=11||O>=.03&&13==e||O>=.02&&14==e||O>=.01&&e>=15||O>=.006&&e>=17)&&(d(e),u(r))}return[i,o]},k=new C.a.Icon({iconUrl:"/svg/marker.svg",iconSize:[25,25]}),x=new C.a.Icon({iconUrl:"/svg/marker-blue.svg",iconSize:[25,25]});function P(e){var t,a=e.data,o=e.area,s=e.initZoom,l=e.mapBounds,i=e.selectedBusFunc,u=e.selectedBusfromParent,m=Object(c.useState)(s),p=Object(n.a)(m,2),f=p[0],d=p[1],b=Object(c.useState)(u),E=Object(n.a)(b,2),g=E[0],B=E[1],C=Object(c.useRef)(),N=Object(c.useRef)(),P=w(Math.max(f,s)),z=Object(n.a)(P,2),T=z[0],U=z[1],F=u?u._id:null,q=a||[],Z=o?[o.lat,o.lng]:[31.791702,-7.09262];function L(){var e=C.current.leafletElement.getBounds(),t=C.current.leafletElement.getZoom(),a=[e.getSouthWest().lng,e.getSouthWest().lat,e.getNorthEast().lng,e.getNorthEast().lat];console.log(a),d(t),U(a)}console.log(q),Object(c.useEffect)((function(){B(u)}),[F]),Object(c.useEffect)((function(){l(T)}),[T]);return r.a.createElement(O.a,(t={onViewportChanged:L,center:Z,zoom:f,minZoom:11},Object(v.a)(t,"onViewportChanged",L),Object(v.a)(t,"ref",C),t),r.a.createElement(j.a,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}),r.a.createElement(_.a,{ref:N},q.map((function(e){var t,a=e.nbrRev?e.totRev/e.nbrRev:0;return r.a.createElement(h.a,{position:[e.location.coordinates[1],e.location.coordinates[0]],icon:(t=e._id,g&&t==g._id?k:x),onClick:function(){return function(e){B(e),i(e,!0)}(e)},onMouseOver:function(t){return function(e,t){e.target.openPopup(),B(t)}(t,e)},key:e._id},g&&r.a.createElement(M.a,{position:[g.location.coordinates[1],g.location.coordinates[0]],autoPan:!1},r.a.createElement("div",null,r.a.createElement("div",{className:y.a.popUpTitle},r.a.createElement(S.Link,{to:"/business/".concat(g._id)},g.name)),r.a.createElement("div",{className:y.a.rating},r.a.createElement(R.a,{name:"customized-color",value:a,precision:.5,size:"small",readOnly:!0}),r.a.createElement("div",null,e.nbrRev," reviews")))))}))))}t.a=function(e){var t=e.businesses,a=e.location,o=e.mapBounds2,s=e.zoom,l=Object(c.useState)(null),i=Object(n.a)(l,2),u=i[0],m=i[1],p=Object(c.useState)(!1),f=Object(n.a)(p,2),d=f[0],E=f[1],v=Object(c.useState)(null),O=Object(n.a)(v,2),j=O[0],_=O[1],h=function(e,t){m(e),E(t)};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:g.a.listMap},r.a.createElement("button",null,r.a.createElement("span",{className:g.a.listMapBtn,onClick:function(){return _("list")}},"List")),r.a.createElement("button",null,r.a.createElement("span",{className:g.a.listMapBtn,onClick:function(){return _("map")}},"Map"))),r.a.createElement("div",{className:g.a.searchResContainer},(!j||"list"==j)&&r.a.createElement(b,{data:t,selectedBus:u,selectedBusFunc:h,scroll:d}),r.a.createElement("div",{className:g.a.fixContainer},r.a.createElement("div",{className:g.a.mapContainer},(!j||"map"==j)&&r.a.createElement(P,{data:t,area:a?{lat:a.lat,lng:a.lng}:{lat:"33.573109",lng:"-7.617050"},mapBounds:function(e){return o(e)},initZoom:s,selectedBusFunc:h,selectedBusfromParent:u})))))}},577:function(e,t,a){"use strict";a.r(t);var n=a(10),c=a(1),r=a.n(c),o=a(105),s=a(164),l=a(38),i=a(77),u=a(173),m=a.n(u),p=a(18),f=a(30),d=a(506),b=a(31);t.default=function(e){var t=Object(c.useContext)(f.a),a=Object(c.useState)([]),u=Object(n.a)(a,2),E=u[0],g=u[1],v=m.a.parse(e.location.search),O=v.location,j=v.name,_=v.locCat,h=Object(p.a)(o.e),M=Object(n.a)(h,2),B=M[0],C=M[1],R=C.data,S=C.loading,N=C.error,y=Object(p.c)(s.f,{variables:{neigh:O}}).data,w="undefined"!=typeof R?R.businesses:[],k="undefined"!=typeof y?y.location:null;return Object(c.useEffect)((function(){var e={query:j,bound:E,limit:20};"city"==_?e.city=O:e.neighborhood=O,B({variables:e})}),[E[0],j,O]),Object(c.useEffect)((function(){N&&t({type:"flashMessage",value:{message:"Something went wrong",type:"error"}})}),[N]),r.a.createElement(i.a,{title:"Search Results",withTopBar:!0},S&&r.a.createElement(l.a,null),r.a.createElement("h2",{className:"searchTitle"},"Results for ",Object(b.b)(j)," in ",Object(b.b)(O)),r.a.createElement(d.a,{businesses:w,location:k,mapBounds2:function(e){g(e)},zoom:12}))}}}]);
//# sourceMappingURL=13.5af44dbd.chunk.js.map